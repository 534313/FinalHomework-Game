# 大作业计划——一个养成类小游戏

## 题设背景

为了完成本次课程的大作业任务，我们希望我们的题设具有以下特点：

1. 基本涵盖了本学期所学的知识点
2. 难度适宜，代码量适宜，容易分工合作
3. 有一定的创意，具备一定的实用性

因此设计了如下任务。

## 题设简介

本次大作业的任务是完成一个小游戏。

游戏背景：你是一位准备复习期末考试的大学生，希望在本次期末考试中取得尽量好的成绩。游戏需要玩家制定每日的复习计划，每门课都有自己的特点：有的课程比较简单，一开始的基础也比较扎实；有的课程复习比较困难，但一旦掌握就不容易遗忘……复习的课程会取得一定的进步，而如果不复习课程则会有一定的遗忘，所以需要根据考试时间安排和课程特点合理安排计划。

游戏采用回合制，将每天视为一个回合，每个回合你可以分别为上午，下午，晚上三个时间段安排复习计划。当天复习过的课程会有进步，但当天没有复习的课程会有所遗忘。此外每个回合都有一定概率触发随机事件，如午睡睡过头（下午的复习效果失效），找到了效果更好的复习资料（这门学科接下来的复习效果会更好），以增加游戏的趣味性。

游戏的最终目标是在本学期取得尽量高的总绩点。

## 流程

本游戏的大致流程如下：

##### 开始游戏/继续游戏

玩家进入初始界面后，可以选择重新开始游戏，或者读取存档文件继续之前的游戏。

开始游戏时，玩家可以指定玩家姓名，以及选择剧本。

##### 执行回合

游戏过程可分为若干回合，每回合的流程如下：

1. 回合开始阶段：加载当前回合的界面（如显示当前各个课程的能力值等）
2. 玩家选择阶段：这一阶段玩家可以通过窗口操作，指定三个时间段的复习计划，并最终提交。
3. 执行计划阶段：接受玩家的复习计划，进行模拟操作，触发随机事件，修改受影响的课程的能力值。同时如同文字冒险类游戏一样，生成对应的文字内容。
4. 回合结束阶段：如果有课程于这一回合对应的日期考试，则模拟这一课程的考试生成最终分数（最终分数为当前能力值+临场发挥系数，后者对应了考场的临场发挥）

##### 结束游戏

当最后一个回合执行结束之后，进入结束界面，输出玩家最终的成绩，并显示历史高分。

也可以查询其他玩家曾经获得过的分数。

## 界面设计

主要包含以下界面：

1. 游戏开始界面，作为游戏开始的入口。
2. 游戏主界面，是每个回合玩家选择阶段，与玩家交互的界面。
3. 文案界面，当玩家提交计划之后，通过显示一段文案（“今天上午复习了高等数学，但效果不太好”）反馈玩家提交计划之后的效果，这是文字冒险类游戏的精髓。
4. 帮助界面，作为一个独立的界面，可以生成帮助，显示游戏的帮助内容。
5. 设置界面，进行一定的选项设置（如调整文字播放速度等）
6. 排行榜：与远程数据库对接，查询玩家的成绩。

## 类设计

本游戏主要包含以下类：

### 课程类（Course）

代表了一个课程，主要包含以下参数：

```c#
    class Course
    {
        int score;
        int reviewBonus;
        int deadline;
        int baseDecrease, incDecrease, lastReview;
        string courseName;
        string description;
    }
```

参数解释：

`Score`: 课程当前的得分。

`ReviewBonus`:该课程一次复习下可以提升的分数。

`Deadline`: 该课程的考试日期对应的回合。

`BaseDecrease`, `IncDecrease`, `LastReview`: 这三个参数影响不复习的情况下的分数降低，分别对应基础值，增加值，以及上次复习过这门课对应的回合。

具体而言，记当前回合为`CurrentTurn`，那么这门课的分数减少为$BaseDecrease+IncDecrease*(CurrentTurn-LastReview)$。

`CourseName`: 课程名。

`Description`: 课程描述，用于在帮助界面呈现。

### 计划类（Plan）

这个类封装了玩家当前回合的选择，当玩家提交计划时，玩家的选择，以及各个回合触发的随机事件会被封装到这么个类当中，传给游戏状态类来执行回合。

重要方法：接收玩家的各个选项，并生成随机事件封装进计划之中。

### 剧本类（Chapter）

这个类封装了玩家选择的游戏剧本。

主要参数包括：剧本内含的课程列表，剧本名称，该剧本的回合总数。、

重要相关方法：构造函数，从文件中读取各个预设剧本。

### 游戏状态类（Game）

这个类表示了当前游戏的状态，包含以下参数：

```c#
    class Game
    {
        int curTurn;
        Chapter GameChapter;
        string playerName;
    }
```

`CurTurn`: 当前所在回合。

`Chapter`: 游戏所选的剧本当前的执行状态。

`PlayerName`: 玩家名称。

重要方法：读取存档文件，生成对应的游戏状态。

该状态包含一个很重要的`ApplyPlan`方法，接受一个Plan，按照Plan内的信息修改受影响的课程。

### 事件类（Event）

包含：事件代码，事件描述，一系列可以表示事件具体影响的参数。

重要方法：一个构造函数，接收事件代码，返回对应的事件。

### 玩家得分（FinalScore）

封装了玩家最终的成绩，包含玩家信息，玩家成绩，玩家选用剧本等。

用于上传远程数据库。

## 希望包含的知识点

类的设计：本作业总共涉及5大类，且互相之间都有交互接口。

至少使用过lambda表达式与LINQ语言

文件读取：体现在读取存档文件，读取预设的剧本。

窗口化界面设计

网络通信，数据库：在远程服务器部署数据库，支持上传玩家最终得分等信息。